{"version":3,"file":"BearbyWallet.js","sourceRoot":"","sources":["../../../src/bearbyWallet/BearbyWallet.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,IAAI,EAAE,MAAM,mBAAmB,CAAC;AACzC,OAAO,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAC;AAGhD,OAAO,EAAE,YAAY,EAAE,MAAM,iBAAiB,CAAC;AAC/C,OAAO,EAAE,UAAU,EAAE,MAAM,WAAW,CAAC;AAEvC,MAAM,OAAO,YAAY;IACf,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC;IAEhC,IAAI;QACT,OAAO,IAAI,CAAC,UAAU,CAAC;IACzB,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,iBAAiB;QAC5B,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE;YACzB,OAAO,IAAI,YAAY,EAAE,CAAC;SAC3B;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAEM,KAAK,CAAC,QAAQ;QACnB,8BAA8B;QAC9B,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE;YAC1B,MAAM,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;SAC7B;QACD,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,EAAE;YAC/B,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;SAC/C;QACD,OAAO,CAAC,IAAI,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;IACzD,CAAC;IAEM,KAAK,CAAC,aAAa;QACxB,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC7C,CAAC;IAEM,KAAK,CAAC,aAAa;QACxB,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC7C,CAAC;IAEM,KAAK,CAAC,YAAY;QACvB,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE;YAC1B,MAAM,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;SAC7B;QACD,OAAO,YAAY,EAAE,CAAC;IACxB,CAAC;IAEM,KAAK,CAAC,SAAS;QACpB,MAAM,IAAI,KAAK,CACb,4DAA4D,CAC7D,CAAC;IACJ,CAAC;IAEM,KAAK,CAAC,kBAAkB;QAC7B,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC7C,CAAC;IAED;;;;;;;;;;;;;;;;;;;;OAoBG;IACI,oBAAoB,CAAC,QAAmC;QAG7D,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAClC,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,IAAI,QAAQ,CAAC,OAAO,CAAC,CAC1C,CAAC;IACJ,CAAC;IAED;;;;;;;;;;;;;;;;;;;;OAoBG;IACI,oBAAoB,CAAC,QAAoC;QAG9D,6DAA6D;QAC7D,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE,CACzC,YAAY,EAAE,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CACpD,CAAC;IACJ,CAAC;IAED;;;;;;OAMG;IACI,KAAK,CAAC,OAAO;QAClB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;IAC/B,CAAC;IAED;;;;;;OAMG;IACI,KAAK,CAAC,UAAU;QACrB,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC;IAClC,CAAC;IAED;;;;OAIG;IACI,KAAK,CAAC,SAAS;QACpB,OAAO,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC;IAC/B,CAAC;IAED;;;;OAIG;IACI,OAAO;QACZ,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;IAC7B,CAAC;CACF","sourcesContent":["import { web3 } from '@hicaru/bearby.js';\nimport { BearbyAccount } from './BearbyAccount';\nimport { Wallet } from '../wallet/interface';\nimport { Network, Provider } from '@massalabs/massa-web3';\nimport { networkInfos } from './utils/network';\nimport { WalletName } from '../wallet';\n\nexport class BearbyWallet implements Wallet {\n  private walletName = WalletName.Bearby;\n\n  public name(): WalletName {\n    return this.walletName;\n  }\n\n  static async createIfInstalled(): Promise<Wallet | null> {\n    if (web3.wallet.installed) {\n      return new BearbyWallet();\n    }\n    return null;\n  }\n\n  public async accounts(): Promise<BearbyAccount[]> {\n    // check if bearby is unlocked\n    if (!web3.wallet.connected) {\n      await web3.wallet.connect();\n    }\n    if (!web3.wallet.account.base58) {\n      throw new Error('No account found on Bearby');\n    }\n    return [new BearbyAccount(web3.wallet.account.base58)];\n  }\n\n  public async importAccount(): Promise<void> {\n    throw new Error('Method not implemented.');\n  }\n\n  public async deleteAccount(): Promise<void> {\n    throw new Error('Method not implemented.');\n  }\n\n  public async networkInfos(): Promise<Network> {\n    if (!web3.wallet.connected) {\n      await web3.wallet.connect();\n    }\n    return networkInfos();\n  }\n\n  public async setRpcUrl(): Promise<void> {\n    throw new Error(\n      'setRpcUrl is not yet implemented for the current provider.',\n    );\n  }\n\n  public async generateNewAccount(): Promise<Provider> {\n    throw new Error('Method not implemented.');\n  }\n\n  /**\n   * Subscribes to account changes.\n   *\n   * @param callback - Callback to be called when the account changes.\n   *\n   * @returns A promise that resolves to a function that can be called to unsubscribe.\n   *\n   * @remarks\n   * Don't forget to unsubscribe to avoid memory leaks.\n   *\n   * @example\n   * ```typescript\n   * // Subscribe\n   * const observer = await provider.listenAccountChanges((base58) => {\n   *  console.log(base58);\n   * });\n   *\n   * // Unsubscribe\n   * observer.unsubscribe();\n   * ```\n   */\n  public listenAccountChanges(callback: (address: string) => void): {\n    unsubscribe: () => void;\n  } {\n    return web3.wallet.account.subscribe(\n      (address) => address && callback(address),\n    );\n  }\n\n  /**\n   * Subscribes to network changes.\n   *\n   * @param callback - Callback to be called when the network changes.\n   *\n   * @returns A promise that resolves to a function that can be called to unsubscribe.\n   *\n   * @remarks\n   * Don't forget to unsubscribe to avoid memory leaks.\n   *\n   * @example\n   * ```typescript\n   * // Subscribe\n   * const observer = await provider.listenNetworkChanges((network) => {\n   *  console.log(network);\n   * });\n   *\n   * // Unsubscribe\n   * observer.unsubscribe();\n   * ```\n   */\n  public listenNetworkChanges(callback: (network: Network) => void): {\n    unsubscribe: () => void;\n  } {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    return web3.wallet.network.subscribe((_) =>\n      networkInfos().then((network) => callback(network)),\n    );\n  }\n\n  /**\n   * Connects to the wallet.\n   *\n   * @remarks\n   * This method will attempt to establish a connection with the wallet.\n   * If the connection fails, it will log the error message.\n   */\n  public async connect() {\n    return web3.wallet.connect();\n  }\n\n  /**\n   * Disconnects from the wallet.\n   *\n   * @remarks\n   * This method will attempt to disconnect from the wallet.\n   * If the disconnection fails, it will log the error message.\n   */\n  public async disconnect() {\n    return web3.wallet.disconnect();\n  }\n\n  /**\n   * Checks if the wallet is connected.\n   *\n   * @returns a boolean indicating whether the wallet is connected.\n   */\n  public async connected(): Promise<boolean> {\n    return web3.wallet.connected;\n  }\n\n  /**\n   * Checks if the wallet is enabled.\n   *\n   * @returns a boolean indicating whether the wallet is enabled.\n   */\n  public enabled(): boolean {\n    return web3.wallet.enabled;\n  }\n}\n"]}